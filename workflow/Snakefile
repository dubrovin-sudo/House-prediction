configfile: "workflow/config.yaml"

REGION_ID = 2661

rule all:
    input:
        "data/raw/all_v2.csv",
        "data/raw/df_spb.csv",
        "data/external/spb_parks.csv",
        "data/external/spb_subways.csv",
        "data/interim/clean_raw_data.csv",
        "data/interim/raw_features.csv",
        "data/interim/subways_features.csv",
        "data/interim/parks_features.csv",
        "data/processed/df_spb_processed.csv"


rule get_processed:
    input:
        "data/interim/clean_raw_data.csv",
        "data/interim/parks_features.csv",
        "data/interim/subways_features.csv",
        "data/interim/raw_features.csv",
    output:
        "data/processed/df_spb_processed.csv"
    shell:
        "python3 -m src.features.get_processed {input[0]} {input[1]} {input[2]}  {input[3]}  {output}"


rule park_features:
    input:
        "data/interim/clean_raw_data.csv",
        "data/external/spb_parks.csv"
    output:
        "data/interim/parks_features.csv"
    shell:
        "python3 -m src.features.park_features {input[0]} {input[1]} {output}"


rule subway_features:
    input:
        "data/interim/clean_raw_data.csv",
        "data/external/spb_subways.csv"
    output:
        "data/interim/subways_features.csv"
    shell:
        "python3 -m src.features.subway_features {input[0]} {input[1]} {output}"


rule raw_features:
    input:
        "data/interim/clean_raw_data.csv"
    output:
        "data/interim/raw_features.csv"
    shell:
        "python3 -m src.features.raw_features {input} {output}"


rule clean_raw:
    input:
        "data/raw/df_spb.csv"
    output:
        "data/interim/clean_raw_data.csv"
    shell:
        "python3 -m src.features.clean_raw {input} {output}"


rule select_region:
    input:
        "data/raw/all_v2.csv"
    output:
        "data/raw/df_spb.csv"
    shell:
        "python3 -m src.features.select_region {input} {output} {REGION_ID}"


rule get_subways:
    output:
        "data/external/spb_subways.csv"
    shell:
        "python3 -m src.data.get_subways {output}"


rule get_parks:
    output:
        "data/external/spb_parks.csv"
    shell:
        "python3 -m src.data.get_parks {output}"


rule get_raw:
    output:
        "data/raw/all_v2.csv",
    shell:
        "python3 -m src.data.get_raw {output}"
