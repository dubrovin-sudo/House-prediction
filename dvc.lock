schema: '2.0'
stages:
  raw_feature:
    cmd: python3 -m src.features.raw_features data/interim/clean_raw_data.csv data/interim/raw_features.csv
    deps:
    - path: data/interim/clean_raw_data.csv
      md5: 66bc7d03ac3d7f3015b2d30254c834c2
      size: 27772010
    - path: src/features/raw_features.py
      md5: 3c5abe41e8d1cbd0c408631f41b01ffc
      size: 1448
    outs:
    - path: data/interim/raw_features.csv
      md5: c8e71f9e903724093261aa47869cc08e
      size: 12201676
  clean_raw:
    cmd: python3 -m src.features.clean_raw data/raw/df_spb.csv data/interim/clean_raw_data.csv
    deps:
    - path: data/raw/df_spb.csv
      md5: 24934a954e81bb0b889e9ee116eab5c4
      size: 34775282
    - path: src/features/clean_raw.py
      md5: 2d6a4c125822a850b778b0b0a02894bf
      size: 1821
    outs:
    - path: data/interim/clean_raw_data.csv
      md5: 66bc7d03ac3d7f3015b2d30254c834c2
      size: 27772010
  get_processed:
    cmd: python3 -m src.features.get_processed data/interim/clean_raw_data.csv data/interim/parks_features.csv
      data/interim/subways_features.csv data/interim/raw_features.csv data/processed/df_spb_processed.csv
    deps:
    - path: data/interim/clean_raw_data.csv
      md5: 66bc7d03ac3d7f3015b2d30254c834c2
      size: 27772010
    - path: data/interim/parks_features.csv
      md5: a58ff0205eba035e203b6f486cad730e
      size: 12168964
    - path: data/interim/raw_features.csv
      md5: c8e71f9e903724093261aa47869cc08e
      size: 12201676
    - path: data/interim/subways_features.csv
      md5: 46f3b8ca9c604aa7c388228ff6b7de09
      size: 20368803
    - path: src/features/get_processed.py
      md5: 8e2b4c68712c83f2bcdd37dc3f611b01
      size: 2491
    outs:
    - path: data/processed/df_spb_processed.csv
      md5: 5f0145e334e77e0f0ab6c432b7d7c557
      size: 70323044
  select_region:
    cmd: python3 -m src.features.select_region data/raw/all_v2.csv data/raw/df_spb.csv
      2661
    deps:
    - path: data/raw/all_v2.csv
      md5: 00af12733984c983b49f412cef232a9f
      size: 408179741
    - path: src/features/select_region.py
      md5: 7a6e3ed4d078f30b1da9ba738b4dbd59
      size: 1021
    outs:
    - path: data/raw/df_spb.csv
      md5: 24934a954e81bb0b889e9ee116eab5c4
      size: 34775282
  prepare_datasets:
    cmd: python3 -m src.models.prepare data/processed/df_spb_processed.csv data/processed/x_trainval.npy
      data/processed/y_trainval.npy data/processed/x_test.npy data/processed/y_test.npy
    deps:
    - path: data/processed/df_spb_processed.csv
      md5: 5f0145e334e77e0f0ab6c432b7d7c557
      size: 70323044
    - path: src/models/prepare.py
      md5: 165817bfa4213fb067c0f581b7401e3b
      size: 1803
    outs:
    - path: data/processed/x_test.npy
      md5: 724218c8a17163300cc981a04b35ee73
      size: 10461184
    - path: data/processed/x_trainval.npy
      md5: 7cdc4a95b81a0fa15d189fe9ef9738d6
      size: 31383296
    - path: data/processed/y_test.npy
      md5: 8d86614bda27e38257ce8e1087f610fb
      size: 653944
    - path: data/processed/y_trainval.npy
      md5: 89f8deeb1b81aade8752c025da6871f9
      size: 1961576
  get_raw:
    cmd: python3 -m src.data.get_raw data/raw/all_v2.csv
    deps:
    - path: src/data/get_raw.py
      md5: 06cfe1f091dd8cc802f6ad52b570ad95
      size: 1193
    outs:
    - path: data/raw/all_v2.csv
      md5: 00af12733984c983b49f412cef232a9f
      size: 408179741
  get_subways:
    cmd: python3 -m src.data.get_subways data/external/spb_subways.csv
    deps:
    - path: src/data/get_subways.py
      md5: a8ef33755cb3d699d08c21496a770fde
      size: 1734
    outs:
    - path: data/external/spb_subways.csv
      md5: 3cff9add70a1981a86c7a24a01f10c2b
      size: 3551
  get_parks:
    cmd: python3 -m src.data.get_parks data/external/spb_parks.csv
    deps:
    - path: src/data/get_parks.py
      md5: e8451eaa1f50ccc984156f8ba1ae2471
      size: 1751
    outs:
    - path: data/external/spb_parks.csv
      md5: f7dba0830cd7b45ed36a3629e02069df
      size: 10535
  park_features:
    cmd: python3 -m src.features.park_features data/interim/clean_raw_data.csv data/external/spb_parks.csv
      data/interim/parks_features.csv
    deps:
    - path: data/external/spb_parks.csv
      md5: f7dba0830cd7b45ed36a3629e02069df
      size: 10535
    - path: data/interim/clean_raw_data.csv
      md5: 66bc7d03ac3d7f3015b2d30254c834c2
      size: 27772010
    - path: src/features/park_features.py
      md5: fa0a79afdd68e46e27022a6b352226de
      size: 2421
    outs:
    - path: data/interim/parks_features.csv
      md5: a58ff0205eba035e203b6f486cad730e
      size: 12168964
  subway_features:
    cmd: python3 -m src.features.subway_features data/interim/clean_raw_data.csv data/external/spb_subways.csv
      data/interim/subways_features.csv
    deps:
    - path: data/external/spb_subways.csv
      md5: 3cff9add70a1981a86c7a24a01f10c2b
      size: 3551
    - path: data/interim/clean_raw_data.csv
      md5: 66bc7d03ac3d7f3015b2d30254c834c2
      size: 27772010
    - path: src/features/subway_features.py
      md5: 723c95035a601bc5d1931d64462a2546
      size: 2531
    outs:
    - path: data/interim/subways_features.csv
      md5: 46f3b8ca9c604aa7c388228ff6b7de09
      size: 20368803
  train:
    cmd: python3 -m src.models.train data/processed/x_trainval.npy data/processed/y_trainval.npy
      data/processed/x_test.npy data/processed/y_test.npy models/model.clf reports/figures/results.json
    deps:
    - path: data/processed/x_trainval.npy
      md5: 7cdc4a95b81a0fa15d189fe9ef9738d6
      size: 31383296
    - path: data/processed/y_trainval.npy
      md5: 89f8deeb1b81aade8752c025da6871f9
      size: 1961576
    - path: src/models/train.py
      md5: 1327375ff59800e2a77edd80bf3079bb
      size: 3017
    outs:
    - path: models/model.clf
      md5: 514fef63195d3fafeb5ab189db7e4b0e
      size: 2861686
    - path: reports/figures/results.json
      md5: da4af2ae6f181cde385926090d0f5b47
      size: 79
  evaluate:
    cmd: python3 -m src.models.evaluate models/model.clf reports/figures/results.json
      data/processed/x_test.npy data/processed/y_test.npy
    deps:
    - path: data/processed/x_test.npy
      md5: 724218c8a17163300cc981a04b35ee73
      size: 10461184
    - path: data/processed/y_test.npy
      md5: 8d86614bda27e38257ce8e1087f610fb
      size: 653944
    - path: models/model.clf
      md5: ecdbb86c2293cdf5d570be702760bb31
      size: 2861771
    - path: src/models/evaluate.py
      md5: 0988dab7e13b9ec25c1cd6ccc61e2825
      size: 1656
    outs:
    - path: reports/figures/results.json
      md5: da4af2ae6f181cde385926090d0f5b47
      size: 79
